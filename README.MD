# KUBERNETES
* Kubernetes, also known as "K8s", is an open-source container orchestration platform developed by Google.
* it is designed to automate the deployment, scaling, and management of containerized applications across a cluster of nodes.
* Kubernetes provides a consistent and reliable way to manage applications, regardless of whether they are running on-premises, in the cloud, or in hybrid environments. 
#### CLUSTER
* **MASTER**
    * Only gives instructions
    * if you dont have workers master has to do everything
    * it also known as control-plane
* **WORKER**
    * they will do work
#### MINI KUBE
* it creates a single node cluster inside the VM.
* it is good for beggainers to  learn kubernetes since you dont have to create a master and worker node to create a cluster.
* we can practice basic kubernetes function and also install kubernetes dashboard onit
#### kubeconfig 
* it is the files contains authentication information to connect kubernetes cluster
* if it is not there we have to setup ```~/.kube/config```
* **kubectl**
* it is kubernetes controler
#### kubernetes commands
* to connect kubernetes cluster we use below command
```
kubectl 
```
* kubectl will check automatically a file
```
~/.kube/config
```
* to connect with nodes with master use below command
```
kubectl get nodes
```
* kubernetes contains lot o resources
* to see all the existing namespaces use below command
```
kubectl get namespaces
kubectl get ns
```
* create resources use below command, if you use this once again, you get error
```
kubectl create -f <your.yamlfile>
```
* if not created it will create, if you use again any changes it will update or it will say unchanged. it won't say any error
```
kubectl apply -f <your.yamlfile>
```
* to see the created or existing resources use below command
```
kubectl get <resource_name>
```
* to see the created or existing pods use below command
```
kubectl get pods
```
* to delete the resources use below command
```
kubectl delete -f <your.yamlfile>
```
* to find the pods in particular namespace use below command
```
kubectl get <pod_name> -n <namespace_name>
kubectl get pods -n <namespace_name>
```
* to login to single container use below command
```
kubectl exec -it <pod-name> -- bash
```
* to login to specific container if we have muliple containers use below command
```
kubectl exec -it <pod-name> -c <container_name> -- bash
```
* to known the full information of a label use below command
```
kubectl describe pod <pod-name> 
```
##### Workload components
1. Namespace
    * it is like a project in your kubernetes cluster to provision your project resources. it is isolated 
    * in kubernetes every resource is YAML
```yaml
apiVersion: v1  # mostly it is v1
kind: Namespace
metadata: # it is nothing but information
  name: hello-pod
```
2. PODs
    * In Kubernetes, a "pod" is the smallest and most basic unit of deployment.It represents a single instance of a running process within the cluster.
    * A pod encapsulates one or more containers, storage resources, network configurations, and other options required to run a specific set of containers together.
    * Pods are typically created and managed using higher- level abstractions such as Deployments, ReplicaSets, or StatefulSets, which provide additional features like scaling, rolling updates, and self-healing capabilities.
    * Pods provide several benefits, including resource isolation, flexible deployment strategies, easy scaling, and enhanced reliability.
    * it is a space where your containers will run
    * **pod Vs container** 
    * A pod can contain multiple containers, it is the smallest thing in kuberenetes
    * pod is a collection of containers
```yaml
apiVersion: v1  # mostly it is v1
kind: Pod
metadata: # it is nothing but information
  name: hello-pod
```
* **RESOURCES IN POD**
* VM vs containerisation
* VM --> 2GB 2CPU --> resources are blocked irrespective of usage
* containerisation --> containers don't block resources, they are used dynamically
* we can restrict the resources consumed by containers...
* **syntax**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: hello-pod
spec:
  # list of containers
  containers:
  - name: hello-pod
    image: nginx
    #here with this line port will not be opened, just for information
    ports:
    - containerPort: 80
    resources:
      requests:
        cpu: "100m"
        memory: "68Mi"
      limits:
        cpu: "200m"
        memory: "128Mi"
```
* where mb is known as mi here
* limit is always greter than or equal to request [limit >= request]


3. spec
    * it is nothing but specifications
    * it gives the information about our pod 
    * to login to a specific container use below command
```yaml
apiVersion: v1  # mostly it is v1
kind: Pod
metadata: # it is nothing but information
  name: hello-pod
spec:
containers: # list of containers      
- name: container-1 # container1
    image: nginx 
    ports:
    - containerPort: 80
- name: container-2 # container2
    image: almalinux:8 
    command: ["sleep","100"]
```
4. labels
  * it is used to select other kubernetes resources
5. annotation
  * annotaions ==> no limit on length and special charecters also can be used...
  * **labels vs annotaions**
      * labels ==> have some limitation on the length and charecters of key and values
      * annotaions ==> no limit on length and special charecters also can be used...
      * labels are used to select other kubernetes resources.
      * annotaions are used to select external resources to kubernetes.
* **syntax**
```yaml
apiVersion: v1  # mostly it is v1
kind: Pod
metadata: # it is nothing but information
  name: labels-demo
  labels:   
    key: <key-name>
    value: "give-value"
  annotation:
    jenkinsurl: "https://jenkins.com"  
```
6. env
* we can use these environment variables with in the container
* go to the container and apply **env** command to see all stored env variables
```yaml
spec:
  # list of containers
  containers:
  - name: hello-pod
    image: nginx
    env:
    - name: DEMO GRRETING
      value: "hello from the environment"
```
7. resources
  * to reques the cpu and memory we use it
  * we contains two types here requests and limits
  * **requests** is soft reuest **limit** it is heard request both will have memory and cpu options
  * **LIMIT >= REQUEST**
8. ConfigMap
  * it is used to store the configureation in the form of key value pair
  * 
* **SYNTAX**
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: devops-config
data:
  course: DevOps
  trainer: "SivakumarReddy"
```
* to refer the configMap from pod using below syntax
* **SYNTAX**
```yaml
env:
    - name: course # user defined name you casn can as you like
      valueFrom:
        configMapKeyRef:
          name: configMap name
          key: key-name
```
* **genral kubernetes syntax**
```yaml
apiVersion: v1  # mostly it is v1
kind: Pod
metadata: # it is nothing but information
  name: hello-pod
  namespace: roboshop
  labels:
    course: aws
    trainer: shiva
spec:
  containers: # list of containers      
  - name: container-1 # container1
    image: nginx 
    ports:
    - containerPort: 80
    resources:
      requests:
        cpu: "100m"
        memory: "68Mi"
      limits:
        cpu: "200m"
        memory: "128Mi"
  - name: container-2 # container2
    image: almalinux:8 
    command: ["sleep","100"]
    env:
    - name: DEMO GRRETING
      value: "hello from the environment"
    env:
    - name: course
      valueFrom:
        configMapKeyRef:
          name: devops-config
          key: course
```
* **where**
    1. image
        * image is pulled from docker hube directly if it is a public image
        * if it is private image we have to push that image to docker hub and then pull it from docker hub
* to pull the private image from docker hub use below command
```
image: <url>/<image:version>
```
* **NOTE**
  * In kind first letter must be capital letter [A-Z]
    ``` kind: [A-Z]a-z```
  * in containerPort **P** must be capital 
  ```- containerPort```
  * in apiVersion **V** is capital
  ```apiVersion```


#### EKSCTL
* eks is amazon elastic kubernetes service
* it is nothing but eks control
* we can create eks cluster by using below command
```
eksctl create cluster --config-file=your.yamlfile
```
* we can delete eks cluster by using below command
```
eksctl delete cluster --config-file=your.yamlfile
```
